## code文件夹文件说明

**==注：请确保打开项目根目录为`code/`==**

**补充：由于本次项目设计多个模型的训练与大量的数据输入与输出，因此如果全部放置在一个notebook中，会导致前后依赖关系不明与输出过多，因此将所有文件代码分开放置。**

#### 数据处理文件夹为用来对原始数据处理的python脚本

- 原始数据从Kaggle比赛中下载，共四个文件[Paris City Brain: Traffic Flow Forecasting | Kaggle](https://www.kaggle.com/competitions/paris-city-brain-traffic-flow-forecasting/data?select=geo_reference.csv)。，下载后将文件放入data文件夹中。

- 首先是通过`时间标签生成.py`文件将原始数据中的所有时间转换为距离`2022-01-01 00:00`的小时数作为新的时间戳，包括所有的原始训练数据与预测数据，并删除无关的列数据。

- 然后我们根据预测数据，通过`提取标签.py`找出训练数据中，所有我们需要预测的摄像头的id，并存入新文件备用。

- 接着根据`预测数据生成.py`，逐行读入预测数据，并在训练数据中找到它的所有前24小时的数据，如果数据不足，则根据这一时间点相隔若干周的数据的均值作为补充值，最终生成一个$预测数据*24$大小的文件。由于数据量极大，因此本步骤极其耗时。

- 最后通过`摊平.py`，将所有不同摄像头的id的数据，通过$index + (id - 5) * 8630 +3$摊平成不区分id的同组数据，并删除id列，因此最终数据仅有`index`与`q`两列。

- 通过以上步骤，我们将生成训练用的`for_train.csv`与预测用的`for_test.csv`两个文件。

#### Linear文件夹为复现的三个Linear模型，包括DLinear, NLinear, RLinear 三个线性模型。

- DLinear模型，它采用了分解的做法，将输入的时间序列分解为趋势与波动，并将两个不同的成分输入到两个不同的线性模型中。其中趋势的提取由移动平均核来生成。因此，当数据明显的具有趋势性时，该模型可以取得远超过简单的线性模型的结果。又本实验的数据具有明显的24小时周期性，因此该模型效果好于预期。
- NLinear模型，它的做法更加直接，它将所有输入的值减去输入的最后一个数据，经过一个简单的线性层，再将减去的值加回来。十分的简单粗暴，因此效果也差于前一个模型。

- Rlinear模型，它是一个简单的线性投影层，但它使用了RevIN技术，这是一种可逆归一化技术，它通过输入数据的统计信息来规范化数据，从而使数据更加规范符合模型的输入。

#### PatchTST文件夹中为PatchTST的所有组件

- 主程序在`PST.py`中，运行轮数600轮，在运行时会输出 每一轮的loss，且最终会保留一张loss图，并将训练后的模型也一并保存。

#### 小组分工

- 数据处理与最终结果PatchTST的实现由吴硕完成
- 三个线性模型与PatchMixer由马逸飞完成

